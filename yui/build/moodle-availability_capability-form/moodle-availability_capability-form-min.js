YUI.add("moodle-availability_capability-form",function(o,a){M.availability_capability=M.availability_capability||{},M.availability_capability.form=o.Object(M.core_availability.plugin),M.availability_capability.form.capabilities=null,M.availability_capability.form.initInner=function(a){this.capabilities=a},M.availability_capability.form.getNode=function(a){var i="cap_"+(new Date).getTime()+"_"+Math.floor(1e5*Math.random()),t='<div class="availability_capability">    <label for="capability_input_'+i+'">'+M.util.get_string("choose","availability_capability")+'</label>    <div class="availability_capability_tag_box" id="capability_tags_container_'+i+'"></div>    <div class="input-group mt-2">        <input type="text" class="form-control" id="capability_input_'+i+'" autocomplete="off" />        <div class="input-group-append">            <span class="input-group-text bg-white border-left-0">                <i class="fa fa-search text-muted"></i>            </span>        </div>    </div>    <ul class="list-group position-absolute w-100 zindex-dropdown mt-1" id="capability_list_'+i+'"           style="max-height: 200px; overflow-y: auto;"></ul></div>',e=o.Node.create("<span>"+t+"</span>");return e.setData("selectedCaps",[]),e.setData("uid",i),this.setupSearchUI(e,i),a.capabilities&&(e.setData("selectedCaps",[]),a.capabilities.forEach(function(a){M.availability_capability.form.createCapabilityTag(e,a,!0)})),e},M.availability_capability.form.fillValue=function(a,i){a.capabilities=i.getData("selectedCaps")||[]},M.availability_capability.form.getValue=function(a){return{capabilities:a.getData("selectedCaps")||[]}},M.availability_capability.form.fillErrors=function(a,i){0===(i.getData("selectedCaps")||[]).length&&a.push("availability_capability:error_nocaps")},M.availability_capability.form.setupSearchUI=function(t,a){var e=t.one("#capability_input_"+a),l=t.one("#capability_list_"+a);e.on("input",function(a){var i=a.target.get("value").toLowerCase();l.setHTML(""),i&&this.capabilities.filter(function(a){return a.toLowerCase().includes(i)}).forEach(function(a){var i=o.Node.create('<li class="list-group-item list-group-item-action p-2 cursor-pointer">'+a+"</li>");i.on("click",function(){e.set("value",""),l.setHTML(""),M.availability_capability.form.createCapabilityTag(t,a)}),l.append(i)})},this)},M.availability_capability.form.createCapabilityTag=function(i,t,e){var l,a=i.getData("uid"),a=i.one("#capability_tags_container_"+a),c=i.getData("selectedCaps");c.includes(t)||(c.push(t),i.setData("selectedCaps",c),(l=o.Node.create('<span class="badge badge-primary mr-1 mb-1">'+t+' <a href="#" class="text-white ml-1" data-cap="'+t+'">&times;</a></span>')).one("a").on("click",function(a){a.preventDefault(),l.remove();a=i.getData("selectedCaps").filter(function(a){return a!==t});i.setData("selectedCaps",a),!e&&M.core_availability&&M.core_availability.form&&"function"==typeof M.core_availability.form.update&&M.core_availability.form.update()}),a.append(l),!e&&M.core_availability&&M.core_availability.form&&"function"==typeof M.core_availability.form.update&&M.core_availability.form.update())}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});